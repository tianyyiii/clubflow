"use strict";(self["webpackChunkclubflow"]=self["webpackChunkclubflow"]||[]).push([[696,680],{3277:function(t,e,s){s.d(e,{Z:function(){return u}});var n=s(3396);const o={class:"container-fluid position-relative",style:{"background-color":"rgba(102, 102, 102, 1)",height:"300px"}},l=(0,n.uE)('<button id="upcover" class="upimg" data-v-32e03cc1><p class="mb-1" style="font-size:28px;" data-v-32e03cc1><span style="font-family:&#39;FontAwesome Regular&#39;, &#39;FontAwesome&#39;, sans-serif;font-weight:400;" data-v-32e03cc1></span></p><p class="mb-0" style="font-size:14px;" data-v-32e03cc1><span style="font-family:&#39;微软雅黑&#39;, sans-serif;font-weight:400;" data-v-32e03cc1>上传封面</span></p></button>',1),i=[l];function a(t,e,s,l,a,r){return(0,n.wg)(),(0,n.iD)("div",o,i)}var r={name:"ClubBanner",components:{},props:["ClubId"]},c=s(89);const d=(0,c.Z)(r,[["render",a],["__scopeId","data-v-32e03cc1"]]);var u=d},1696:function(t,e,s){s.r(e),s.d(e,{default:function(){return at}});var n=s(3396),o=s(7139),l=s(9242);const i=t=>((0,n.dD)("data-v-7b10d406"),t=t(),(0,n.Cn)(),t),a={class:"mt-3 d-flex px-3 py-3 mx-4 align-items-center justify-content-between",style:{"border-bottom":"rgb(233, 233, 233) 1px solid"}},r={class:"mx-5 d-inline-flex align-items-center"},c={id:"userimg",class:"me-4 d-flex position-relative"},d=["src"],u={class:""},m={class:"mb-0",style:{"font-size":"18px"}},f={style:{"font-family":"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑', sans-serif","font-weight":"700",color:"#666666"}},p={class:"mb-0",style:{"font-size":"14px"}},g={style:{"font-family":"'微软雅黑', sans-serif","font-weight":"400",color:"#999999"}},h={class:"d-flex",style:{"font-size":"18px",color:"#A4A4A4"}},b={class:"text-center",style:{width:"140px","border-right":"1px rgb(228, 228, 228) solid"}},v=i((()=>(0,n._)("p",{class:"mb-1",style:{"font-size":"14px"}},[(0,n._)("span",{style:{"font-family":"'微软雅黑', sans-serif","font-weight":"400",color:"#999999"}},"粉丝")],-1))),y={class:"mb-0",style:{"font-size":"20px"}},x={style:{"font-family":"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑', sans-serif","font-weight":"700",color:"#666666"}},I={class:"text-center",style:{width:"140px","border-right":"1px rgb(228, 228, 228) solid"}},_=i((()=>(0,n._)("p",{class:"mb-1",style:{"font-size":"14px"}},[(0,n._)("span",{style:{"font-family":"'微软雅黑', sans-serif","font-weight":"400",color:"#999999"}},"文章")],-1))),w={class:"mb-0",style:{"font-size":"20px"}},C={style:{"font-family":"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑', sans-serif","font-weight":"700",color:"#666666"}},U={class:"row container-fluid d-flex justify-content-center py-5",style:{"background-color":"rgb(249, 249, 249)"}},z={id:"basic-info",class:"col-md-6 me-5"},k=i((()=>(0,n._)("div",{class:""},[(0,n._)("span",{class:"ms-2 me-2",style:{"font-family":"'FontAwesome', sans-serif","font-size":"22px"}},""),(0,n._)("span",{style:{"font-family":"'Microsoft JhengHei UI', sans-serif","font-size":"16px",color:"#B82D29"}},"资料卡"),(0,n._)("div",{class:"mt-1",style:{"background-color":"rgb(228, 228, 228)",height:"8px"}})],-1))),P={class:"px-2 py-4"},A={style:{"font-family":"'华文宋体', sans-serif","font-size":"14px","line-height":"18px"}},B={class:"w-100 px-5 my-2 d-flex justify-content-end"},D=i((()=>(0,n._)("button",{class:"re-btn me-2"},"重置",-1))),N={class:"col-md-4 ms-4"},j=i((()=>(0,n._)("div",{class:""},[(0,n._)("span",{class:"ms-2 me-2",style:{"font-family":"'FontAwesome', sans-serif","font-size":"22px"}},""),(0,n._)("span",{style:{"font-family":"'Microsoft JhengHei UI', sans-serif","font-size":"16px",color:"#B82D29"}},"粉丝列表"),(0,n._)("div",{class:"mt-1",style:{"background-color":"rgb(228, 228, 228)",height:"8px"}})],-1))),E={class:"py-3 px-4"},F={class:"me-5 mt-3 text-center float-start",style:{"list-style-type":"none","text-align":"center"}},R=["src"],$={class:"my-1",style:{"font-size":"15px",color:"#999999"}},H={class:"mt-5 px-5 mx-4"},L=i((()=>(0,n._)("div",{class:""},[(0,n._)("span",{class:"ms-2 me-2",style:{"font-family":"'FontAwesome', sans-serif","font-size":"22px"}},""),(0,n._)("span",{style:{"font-family":"'Microsoft JhengHei UI', sans-serif","font-size":"16px",color:"#B82D29"}},"发表文章"),(0,n._)("div",{class:"mt-1",style:{"background-color":"rgb(228, 228, 228)",height:"8px"}})],-1))),T={class:"my-3 px-1"},q={class:"px-0 pt-1 mt-5 container-fluid",style:{"background-color":"#f9f9f9","padding-bottom":"200px"}},M={class:"mt-5 px-5 mx-4"};function Z(t,e,s,i,Z,S){const W=(0,n.up)("ClubBanner"),J=(0,n.up)("UpImage"),Q=(0,n.up)("PostEdit"),Y=(0,n.up)("HistoryArticles");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(W,{ClubId:Z.ClubId},null,8,["ClubId"]),(0,n._)("div",a,[(0,n._)("div",r,[(0,n._)("div",c,[(0,n._)("img",{class:"rounded-circle",src:Z.ClubInfo.Profile,alt:"用户头像",style:{width:"79px",height:"79px"}},null,8,d),(0,n.Wm)(J,{onUpUrl:S.getImgURL,class:"position-absolute"},null,8,["onUpUrl"])]),(0,n._)("div",u,[(0,n._)("p",m,[(0,n._)("span",f,(0,o.zw)(Z.ClubInfo.Name),1)]),(0,n._)("p",p,[(0,n._)("span",g,(0,o.zw)(Z.ClubInfo.Inform),1)])])]),(0,n._)("div",h,[(0,n._)("div",b,[v,(0,n._)("p",y,[(0,n._)("span",x,(0,o.zw)(Z.ClubInfo.FansNumber),1)])]),(0,n._)("div",I,[_,(0,n._)("p",w,[(0,n._)("span",C,(0,o.zw)(Z.ClubInfo.PubNum),1)])])])]),(0,n._)("div",U,[(0,n._)("div",z,[k,(0,n._)("div",P,[(0,n._)("div",A,(0,o.zw)(Z.ClubInfo.Announcement),1),(0,n.wy)((0,n._)("textarea",{"onUpdate:modelValue":e[0]||(e[0]=t=>Z.newAnnouncement=t),id:"intro-text",class:"form-control mt-5",placeholder:"请输入协会简要介绍信息。不超过500字。",maxlength:"500",name:"text",style:{height:"160px","border-radius":"3px","font-size":"14px"}},null,512),[[l.nr,Z.newAnnouncement]])]),(0,n._)("div",B,[D,(0,n._)("button",{onClick:e[1]||(e[1]=(...t)=>S.submitAnnouncement&&S.submitAnnouncement(...t)),class:"sav-btn"},"提交")])]),(0,n._)("div",N,[j,(0,n._)("ul",E,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Z.fanProfiles,(t=>((0,n.wg)(),(0,n.iD)("li",F,[(0,n._)("img",{class:"rounded-circle",src:t.image,alt:"用户头像",style:{width:"50px",height:"50px"}},null,8,R),(0,n._)("p",$,(0,o.zw)(t.name),1)])))),256))])])]),(0,n._)("div",H,[L,(0,n._)("div",T,[(0,n.Wm)(Q,{ClubId:Z.ClubId},null,8,["ClubId"])])]),(0,n._)("div",q,[(0,n._)("div",M,[(0,n.Wm)(Y,{ClubId:Z.ClubId},null,8,["ClubId"])])])],64)}s(7658);var S=s(3277);const W={class:"w-100 px-5 my-2 d-flex justify-content-end"},J=(0,n.uE)('<div class="modal fade modal-sm" id="showstatus" data-v-a902d7d0><div class="modal-dialog" data-v-a902d7d0><div class="modal-content" data-v-a902d7d0><div class="modal-header" data-v-a902d7d0><button type="button" class="btn-close" data-bs-dismiss="modal" data-v-a902d7d0></button></div><div class="modal-body text-center" style="font-size:20px;" data-v-a902d7d0><i class="fa fa-check-circle" aria-hidden="true" style="color:green;" data-v-a902d7d0></i> 发布成功 </div></div></div></div>',1);function Q(t,e,s,o,i,a){const r=(0,n.up)("QuillEditor");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",null,[(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>i.title=t),class:"mb-4",type:"text",placeholder:"请输入文章标题",maxlength:"30"},null,512),[[l.nr,i.title]])]),(0,n.Wm)(r,{ref:"myQuillEditor",content:i.content,"onUpdate:content":e[1]||(e[1]=t=>i.content=t),options:i.editorOption,contentType:"html",style:{height:"450px"}},null,8,["content","options"]),(0,n._)("div",W,[(0,n._)("button",{onClick:e[2]||(e[2]=t=>a.submit()),class:"sav-btn"},"发布")]),J],64)}var Y=s(4870),O=s(6149),K=s(1981),V=s(9205);const X=[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image"]];O.CX.register(V.Z,!0),O.CX.register("modules/ImageExtend",K.uq);var G={name:"PostEdit",props:["ClubId","model"],components:{QuillEditor:O.Bn},data(){return{content:"",title:"",coverURL:"",myQuillEditor:(0,Y.iH)(),editorOption:{theme:"snow",modules:{ImageExtend:{loading:!0,name:"file",action:(0,n.FN)()?.appContext.config.globalProperties.$Baseurl+"comment/image",headers:t=>{},response:t=>(this.coverURL||(this.coverURL=t.imgURL),console.log(this.coverURL),t.imgURL),size:8,sizeError:()=>{this.$message.error("粘贴图片大小不能超过8MB!")}},toolbar:{container:X,handlers:{image:function(t){K.uv.emit(this.quill.id)},link:function(t){if(t){var e=prompt("请输入链接地址：");this.quill.format("link",e)}else this.quill.format("link",!1)}}}}}}},methods:{submit(){if(console.log(this.content),console.log(this.ClubId),this.title){var t=this.$store.state.UserId,e=this;this.$axios.put("/post/create",{title:e.title,context:e.content,image:e.coverURL,clubId:e.ClubId,UserId:t}).then((t=>{console.log(t),1===t.data.state?(alert("发布成功！"),location.reload()):2===t.data.state?alert("超时！"):alert("标题重复！")})).catch((t=>{alert("发布失败！")}))}else alert("请输入标题！")}}},tt=s(89);const et=(0,tt.Z)(G,[["render",Q],["__scopeId","data-v-a902d7d0"]]);var st=et,nt=s(5036),ot=s(9680),lt={name:"ClubEditPage",components:{ClubBanner:S.Z,PostEdit:st,HistoryArticles:nt.Z,UpImage:ot["default"]},data(){return{ClubId:0,UserId:0,IsLogin:!1,ClubInfo:{CreateTime:"2011-03-30",Name:"xx协会",Category:"文化艺术类",FansNumber:0,Profile:s(100),PubNum:0,Subscribe:0,CommentNum:0,Inform:"",Announcement:"介绍协会。协会简介。"},fanProfiles:[],fans:null,newAnnouncement:""}},methods:{submitAnnouncement(){var t={ClubId:this.ClubId,UserId:this.UserId,context:this.newAnnouncement};this.$axios.post("club/announcement/modify",t).then((t=>{console.log(t),1==t.data.state?(alert("修改成功！"),location.reload()):alert("错误！",t.data.state)})).catch((t=>{console.log(t)}))},checkImgUrl(t){var e=/^http/g,s=e.test(t);return s},getClubInfo(){return new Promise(((t,e)=>{let s=this;this.$axios.get("club/get_created_club",{params:{UserId:this.UserId}}).then((e=>{this.ClubId=e.data.clubId;var n=new Date(e.data["createdDate"]);if(this.ClubInfo.CreateTime=n.Format("yyyy-MM-dd"),this.ClubInfo.Name=e.data.clubName,this.ClubInfo.FansNumber=e.data["fansNum"],e.data.image){var o=s.checkImgUrl(e.data.image);o&&(this.ClubInfo.Profile=e.data.image)}this.ClubInfo.PubNum=e.data["publicationsNum"],this.ClubInfo.Subscribe=e.data.subscribe,this.ClubInfo.CommentNum=e.data["commentsNum"],this.ClubInfo.Inform=e.data.clubInfo,e.data.announcement&&(this.ClubInfo.Announcement=e.data.announcement),this.viewFans(),t("社团基本信息完成请求")})).catch((t=>{console.log(t)}))}))},viewFans(){this.$axios.get("/club/view_fans",{params:{ClubId:this.ClubId}}).then((t=>{this.fans=t.data;let e=this.fans;for(let o in e){var n=this.checkImgUrl(this.fans[o].image);n?this.fanProfiles.push({image:this.fans[o].image,name:this.fans[o].name}):this.fanProfiles.push({image:s(7566),name:this.fans[o].name})}})).catch((t=>{console.log(t)}))},getImgURL(t){console.log("image:",t),this.ClubInfo.Profile=t;var e={name:this.ClubInfo.Name,ClubId:this.ClubId,UserId:this.UserId,inform:this.ClubInfo.Inform,image:this.ClubInfo.Profile};this.$axios.post("club/modify",e).then((t=>{console.log(t);var e=t.data;1==e.state&&alert("头像上传成功！")})).catch((t=>{console.log(t)}))},async getAllPageInfo(){await this.getClubInfo()}},created(){this.ClubId=this.$route.query.ClubId,this.UserId=this.$store.state.UserId,String(this.UserId)?this.IsLogin=!0:this.UserId=0},mounted(){this.UserId&&this.getAllPageInfo()}};const it=(0,tt.Z)(lt,[["render",Z],["__scopeId","data-v-7b10d406"]]);var at=it},5036:function(t,e,s){s.d(e,{Z:function(){return D}});var n=s(3396),o=s(7139),l=s(2207),i=s(7940);const a=t=>((0,n.dD)("data-v-4f34acb4"),t=t(),(0,n.Cn)(),t),r=a((()=>(0,n._)("div",{class:""},[(0,n._)("span",{class:"ms-2 me-2",style:{"font-family":"'FontAwesome', sans-serif","font-size":"22px"}},""),(0,n._)("span",{style:{"font-family":"'Microsoft JhengHei UI', sans-serif","font-size":"16px",color:"#B82D29"}},"历史文章"),(0,n._)("div",{class:"mt-1",style:{"background-color":"rgb(228, 228, 228)",height:"8px"}})],-1))),c={class:"list-group m-0 p-0"},d=["onClick"],u={class:"img-box flex-shrink-0"},m=["src"],f={key:1,src:l},p={class:"gap-2 w-100 position-relative"},g={class:"d-flex w-100 justify-content-between"},h={class:"mb-0",style:{"font-family":"'微软雅黑', sans-serif","font-weight":"600","font-size":"16px"}},b={class:"textlines-overflow-2 mt-2 ms-1 mb-0",style:{"font-family":"'微软雅黑', sans-serif","font-weight":"400","font-size":"13px",color:"#999999","text-align":"left"}},v={class:"opacity-50 text-nowrap",style:{"font-size":"12px"}},y=a((()=>(0,n._)("i",{class:"fa fa-clock-o","aria-hidden":"true"},null,-1))),x={class:"d-flex w-100 position-absolute bottom-0 justify-content-between align-items-baseline"},I={class:"d-inline-flex align-items-center"},_={class:"user-img-box flex-shrink-0",style:{width:"24px",height:"24px",overflow:"hidden"}},w=["src"],C={key:1,src:i},U={class:"ms-2",style:{"font-family":"'微软雅黑', sans-serif","font-weight":"400","font-size":"12px",color:"#999999"}},z={class:"m-0",style:{"font-family":"'FontAwesome', '微软雅黑', sans-serif","font-weight":"400","font-size":"13px",color:"#999999"}};function k(t,e,s,l,i,a){return(0,n.wg)(),(0,n.iD)("div",null,[r,(0,n._)("ul",c,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.posts_json,(t=>((0,n.wg)(),(0,n.iD)("a",{onClick:e=>a.jumpToPost(t.postId),class:"list-group-item list-group-item-action d-flex gap-3 py-3 overflow-hidden","aria-current":"true",style:{"border-radius":"0"}},[(0,n._)("div",u,[t.haveimage?((0,n.wg)(),(0,n.iD)("img",{key:0,src:t.image},null,8,m)):((0,n.wg)(),(0,n.iD)("img",f))]),(0,n._)("div",p,[(0,n._)("div",g,[(0,n._)("div",null,[(0,n._)("h6",h,(0,o.zw)(t.title),1),(0,n._)("p",b,(0,o.zw)(t.context),1)]),(0,n._)("small",v,[y,(0,n.Uk)(" "+(0,o.zw)(t.date),1)])]),(0,n._)("div",x,[(0,n._)("div",I,[(0,n._)("div",_,[t["haveclub profile"]?((0,n.wg)(),(0,n.iD)("img",{key:0,src:t["club profile"]},null,8,w)):((0,n.wg)(),(0,n.iD)("img",C))]),(0,n._)("span",U,(0,o.zw)(t["club name"]),1)]),(0,n._)("p",z,"  "+(0,o.zw)(t["thumbs-up num"])+"   "+(0,o.zw)(t["comments num"])+"   -- ",1)])])],8,d)))),256))])])}s(7658);var P={name:"HistoryArticles",props:["ClubId"],data(){return{Club:0,UserId:0,posts:null,posts_json:[]}},methods:{jumpToPost(t){this.$router.push({path:"/postdetails",query:{PostId:t}})},checkImgUrl(t){var e=/^http/g,s=e.test(t);return s},check_img_fields:function(t){let e=this;this.posts_json.forEach((function(s){void 0!=s[t]&&""!=s[t]&&e.checkImgUrl(s[t])?(s["have"+t]=!0,s[t+"forurl"]=s[t]):s["have"+t]=!1}))},convertIdeogramToNormalCharacter(t){const e={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return t.replace(/&(lt|gt|nbsp|amp|quot);/gi,(function(t,s){return e[s]}))},getPlainText(t){let e=t;if(t)return e=e.replace(/\s*/g,""),e=e.replace(/<[^>]+>/g,""),e=e.replace(/↵/g,""),e=e.replace(/[\r\n]/g,""),e=e.replace(/&nbsp;/g,""),e=this.convertIdeogramToNormalCharacter(e),e},getPosts(){let t=this;this.$axios.get("post/view_by_club",{params:{ClubId:this.Club,UserId:this.UserId}}).then((e=>{this.posts=e.data;let s=this.posts;for(let t in s)this.posts_json.push(s[t]);for(var n=["image","club profile"],o=0,l=n.length;o<l;o++){var i=n[o];t.check_img_fields(i)}this.posts_json.forEach((function(e){void 0!=e.context&&(e.context=t.getPlainText(e.context))})),this.posts_json.forEach((function(t){if(void 0!=t.date){var e=new Date(t.date);t.date=e.Format("yyyy-MM-dd hh:mm")}}))})).catch((function(t){console.log(t)}))}},created(){this.UserId=this.$store.state.UserId,String(this.UserId)||(this.UserId=0)},watch:{ClubId:{immediate:!0,deep:!0,handler(t,e){this.Club=t,void 0!=this.Club&&this.getPosts()}}}},A=s(89);const B=(0,A.Z)(P,[["render",k],["__scopeId","data-v-4f34acb4"]]);var D=B},9680:function(t,e,s){s.r(e),s.d(e,{default:function(){return u}});var n=s(3396),o=s(7139),l=s(4870),i=s(7178),a=s(2655),r=s(2748),c={__name:"UpImage",props:{product_id:Number},emits:["upUrl"],setup(t,{emit:e}){const s=(0,l.qj)([]),c=(0,n.FN)()?.appContext.config.globalProperties.$Baseurl+"comment/image",d=(0,l.qj)({showBtnDealImg:!0,noneBtnImg:!1}),u=(0,l.iH)(0),m=t=>{console.log("上传前端校验",t);const e=t.size/1024/1024<2;t.type;if(!e)return i.z8.success({message:"上传图片不能超过2MB哦!"}),!1},f=(t,s)=>{console.log("handleSuccessres",t),console.log("handleSuccessfile",s),t?(i.z8.success({message:"上传成功!"}),e("upUrl",s.response.imgURL)):i.z8.error({message:"上传失败，请重新上传"})},p=(t,e)=>{console.log("file---",t),console.log("fileList---",e),d.noneBtnImg=e.length>=1},g=(t,e,s)=>{u.value=Math.floor(t.percent)},h=(t,e)=>{const s=new Promise(((s,n)=>{a.T.confirm("此操作将删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let s=e.indexOf(t);e.splice(s,1),d.noneBtnImg=!1})).catch((()=>{n(!1)}))}));return s};return(t,e)=>{const i=(0,n.up)("el-icon"),a=(0,n.up)("el-upload");return(0,n.wg)(),(0,n.j4)(a,{"list-type":"picture-card",action:c,class:(0,o.C_)({uoloadBtn:d.showBtnDealImg,disUoloadBtn:d.noneBtnImg}),"on-change":p,"on-success":f,"before-upload":m,"on-progress":g,"before-remove":h,"file-list":s,multiple:!0,limit:1},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{class:"avatar-uploader-icon"},{default:(0,n.w5)((()=>[(0,n.Wm)((0,l.SU)(r.v37))])),_:1})])),_:1},8,["class","file-list"])}}};const d=c;var u=d},100:function(t,e,s){t.exports=s.p+"img/default-user-round-dark.17041ec4.png"},2207:function(t,e,s){t.exports=s.p+"img/default_img.ea648e07.png"}}]);
//# sourceMappingURL=696.cff6a8cb.js.map
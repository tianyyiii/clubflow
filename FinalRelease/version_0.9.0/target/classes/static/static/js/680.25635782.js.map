{"version":3,"file":"js/680.25635782.js","mappings":"kTAsCMA,GAAWC,EAAAA,EAAAA,IAAS,IACpBC,GAASC,EAAAA,EAAAA,OAAsBC,WAAWC,OAAOC,iBAAiBC,SAAW,gBAC7EC,GAASP,EAAAA,EAAAA,IAAS,CAACQ,gBAAe,EAAMC,YAAW,IAEnDC,GAAUC,EAAAA,EAAAA,IAAI,GAEdC,EAAgBC,IACtBC,QAAQC,IAAI,SAAUF,GACtB,MAAMG,EAASH,EAAKI,KAAO,KAAO,KAAO,EAC5BJ,EAAKK,KAClB,IAAKF,EAID,OAHAG,EAAAA,GAAAA,QAAkB,CAClBC,QAAS,mBAEF,CACX,EAKMC,EAAgB,CAACC,EAAKT,KAC5BC,QAAQC,IAAI,mBAAoBO,GAChCR,QAAQC,IAAI,oBAAqBF,GAC7BS,GACAH,EAAAA,GAAAA,QAAkB,CACdC,QAAS,UAEbG,EAAK,QAAQV,EAAKW,SAASC,SAE3BN,EAAAA,GAAAA,MAAgB,CACZC,QAAS,cAEjB,EAGMM,EAAe,CAACb,EAAMd,KACxBe,QAAQC,IAAI,UAAWF,GACvBC,QAAQC,IAAI,cAAehB,GAC3BQ,EAAQE,WAAaV,EAAS4B,QAAU,CAAC,EAGvCC,EAAgB,CAACC,EAAOhB,EAAMd,KAEpCW,EAAQoB,MAAQC,KAAKC,MAAMH,EAAMnB,QAAQ,EAGnCuB,EAAe,CAACpB,EAAMd,KAC5B,MAAMmC,EAAS,IAAIC,SAAQ,CAACC,EAASC,KACjCC,EAAAA,EAAAA,QAAqB,mBAAoB,KAAM,CAC3CC,kBAAmB,KACnBC,iBAAkB,KAClBtB,KAAM,YAETuB,MAAK,KACF,IAAIC,EAAQ3C,EAAS4C,QAAQ9B,GAC7Bd,EAAS6C,OAAOF,EAAO,GACvBnC,EAAQE,YAAa,CAAK,IAG7BoC,OAAM,KACHR,GAAO,EAAM,GACf,IAEN,OAAOH,CAAM,E,+dChGb,MAAMY,EAAc,EAEpB,O","sources":["webpack://clubflow/./src/components/common/UpImage.vue","webpack://clubflow/./src/components/common/UpImage.vue?aab0"],"sourcesContent":["<template>\r\n    <el-upload\r\n        list-type=\"picture-card\"\r\n        :action=action\r\n        :class=\"{uoloadBtn:classes.showBtnDealImg,disUoloadBtn:classes.noneBtnImg}\"\r\n        :on-change=\"handleChange\"\r\n        :on-success=\"handleSuccess\"\r\n        :before-upload=\"beforeUpload\"\r\n        :on-progress=\"uploadProcess\"\r\n        :before-remove=\"beforeRemove\"\r\n        :file-list=\"fileList\"\r\n        :multiple=\"true\"\r\n        :limit=\"1\"\r\n      >\r\n        <el-icon class=\"avatar-uploader-icon\">\r\n          <Plus/>\r\n        </el-icon>\r\n    </el-upload>\r\n</template>\r\n\r\n<style>\r\n.disUoloadBtn .el-upload--picture-card{\r\n    display:none;   /* 上传按钮隐藏 */\r\n}\r\n</style>\r\n\r\n<script setup>\r\nimport {reactive,ref,getCurrentInstance} from 'vue'\r\nimport{ElMessage,ElMessageBox} from 'element-plus'\r\nimport { Plus } from \"@element-plus/icons-vue\";\r\n\r\n// 可以在上传文件里console(fileList),会返回数据结构\r\n\r\nconst props = defineProps({\r\nproduct_id: Number,\r\n});\r\nconst emit = defineEmits([\"upUrl\"])\r\n\r\nconst fileList = reactive([]); // 上传图片\r\nconst action = getCurrentInstance()?.appContext.config.globalProperties.$Baseurl + 'comment/image' // 服务器地址\r\nconst classes= reactive({showBtnDealImg:true, noneBtnImg:false})\r\n\r\nconst percent = ref(0);\r\n// 上传前校验\r\nconst beforeUpload = (file) => {\r\nconsole.log('上传前端校验', file);\r\nconst isLt2M = file.size / 1024 / 1024 < 2;\r\nconst type = file.type;\r\nif (!isLt2M) {\r\n    ElMessage.success({\r\n    message: '上传图片不能超过2MB哦!',\r\n    });\r\n    return false;\r\n}\r\n//   if(type.includes('jpg'))\r\n};\r\n\r\n//上传成功回调\r\nconst handleSuccess = (res, file) => {\r\nconsole.log('handleSuccessres', res);\r\nconsole.log('handleSuccessfile', file);\r\nif (res) {\r\n    ElMessage.success({\r\n        message: '上传成功!',\r\n    });\r\n    emit(\"upUrl\",file.response.imgURL)\r\n} else {\r\n    ElMessage.error({\r\n        message: '上传失败，请重新上传',\r\n    });\r\n}\r\n};\r\n//上传文件\r\nconst handleChange = (file, fileList) => {\r\n    console.log('file---', file);\r\n    console.log('fileList---', fileList);\r\n    classes.noneBtnImg = fileList.length >= 1;\r\n};\r\n// 上传时候的钩子\r\nconst uploadProcess = (event, file, fileList) => {\r\n// console.log(event.percent);\r\npercent.value = Math.floor(event.percent);\r\n};\r\n// 删除\r\nconst beforeRemove = (file, fileList) => {\r\nconst result = new Promise((resolve, reject) => {\r\n    ElMessageBox.confirm('此操作将删除该图片, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n    })\r\n    .then(() => {\r\n        let index = fileList.indexOf(file);\r\n        fileList.splice(index, 1);\r\n        classes.noneBtnImg = false;\r\n        // 请求删除接口\r\n    })\r\n    .catch(() => {\r\n        reject(false);\r\n    });\r\n});\r\nreturn result;\r\n};\r\n\r\n\r\n</script>","import script from \"./UpImage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./UpImage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./UpImage.vue?vue&type=style&index=0&id=5ead0b2a&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["fileList","reactive","action","getCurrentInstance","appContext","config","globalProperties","$Baseurl","classes","showBtnDealImg","noneBtnImg","percent","ref","beforeUpload","file","console","log","isLt2M","size","type","ElMessage","message","handleSuccess","res","emit","response","imgURL","handleChange","length","uploadProcess","event","value","Math","floor","beforeRemove","result","Promise","resolve","reject","ElMessageBox","confirmButtonText","cancelButtonText","then","index","indexOf","splice","catch","__exports__"],"sourceRoot":""}